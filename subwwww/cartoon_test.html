<!DOCTYPE html>
<html>
<head>
	<meta http-equiv="Access-Control-Allow-Origin" content="*">

    <!-- Global site tag (gtag.js) - Google Analytics -->
    <script>
    window.dataLayer = window.dataLayer || [];
    function gtag(){dataLayer.push(arguments);}
    gtag('js', new Date());

    gtag('config', 'UA-173468417-1');
    </script>

    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge">


    <title>Cartoonizer</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/semantic-ui@2.3.3/dist/semantic.min.css">
    <script
        src="https://code.jquery.com/jquery-3.1.1.min.js"
        integrity="sha256-hVVnYaiADRTO2PzUGmuLJr8BLUSjGIZsDYGmIJLv2b8="
        crossorigin="anonymous">
    </script>
    <script src="https://cdn.jsdelivr.net/npm/semantic-ui@2.3.3/dist/semantic.min.js"></script>
    <style>
        html {
        box-sizing: border-box;
        }
        *, *:before, *:after {
        box-sizing: inherit;
        }
        body{
            background-color: whitesmoke;
        }


    </style>
</head>

<body>

<div class="ui padded centered grid">
 


        <div id="loader" class="ui disabled dimmer">
                <div class="ui text loader">Preparing your cartoon! May take an extra few seconds for video :)</div>
              </div>


 
    

    <!-- Heading of the page -->
    <div class="row">
        <div class='center aligned column'>
			<h1>卡通风测试（免费风格模型）</h1>
			<h3>微信客服: kefu_motionface</h3>
        </div>
    </div>
    
    <!-- Submission form -->
    <div class="row">
        <div class='center aligned column'>
            <form id='formsubmit' method="post" action="https://cartoonize-lkqov62dia-de.a.run.app/cartoonize" enctype = "multipart/form-data" target="hidden_frame">
    
                <div class="ui buttons">
                    <div id='uploadimage' class="ui button" style="align-items: center;">
                        <i class="image icon"></i>
                        Image/图片
                    </div>
                    <div class="or"></div>
                    <div id='uploadvideo' class="ui button" style="align-items: center;">
                        <i class="video icon"></i>
                        Video/视频
                        <span style="font-size: 10px;"></span>
                    </div>
                </div>
        
                <input type='file' id='hiddeninputfile' accept="image/*" name = 'image' style="display: none"/>
                <input type="file" id="hiddeninputvideo" accept="video/*" name = 'video' style="display: none">
                <!-- <input id='submitbutton' class='ui button' type='submit'/> -->
            </form>
			<iframe name='hidden_frame' id="hidden_frame" ref="iframe" style="pointer-events: none"
			width="100%"
			height="720"
			marginWith="0"	
			scrolling="no" ></iframe>

        </div>
    </div>
     
 </div>

<script>
 
    $("#uploadimage").on("click", function() {
        $('#hiddeninputfile').click(); 
    });

    $("#uploadvideo").on("click", function() {
        //$('#hiddeninputvideo').click(); 
		alert("请选择图片测试，或者联系客服微信 kefu_motionface");

    });

    document.getElementById("hiddeninputfile").onchange = function() {
        $('#loader').removeClass('disabled').addClass('active');
        document.getElementById("formsubmit").submit();
		
          //  formData.append("image", this.files[0], this.value);
         //   $.ajax({
         //       type: "POST",
         //       url: 'https://cartoonize-lkqov62dia-de.a.run.app/cartoonize',
        //        data: formData,
         //       contentType: false, //必须
         //       processData: false, //必须
		//		dataType: 'jsonp',  // 请求方式为jsonp
		//		crossDomain: true,
		//		jsonp: "callback",
         //       jsonpCallback: "callback",
        //        success: function (res) {
		//			alert("结果1 "+res);
        //            var reg = /<img\s+.*?src\s*=\s*(["'])([^.]+?(?:\.(jpg|jpeg|png|gif)))\1[^/]*?\/?>/ig;
 　　	//			var result = res.match(reg);
 　　	//			alert("结果2 "+result);
         //       },
         //       error: function (err ) {
         //            alert("出现故障！"+err);
		//			 $('#loader').removeClass('active');
         //       }
        //});  
 

        
    };
    document.getElementById("hiddeninputvideo").onchange = function() {
        const fi = document.getElementById('hiddeninputvideo'); 
		return;
        // Check if any file is selected. 
        if (fi.files.length > 0) { 
            for (const i = 0; i <= fi.files.length - 1; i++) { 
  
                const fsize = fi.files.item(i).size; 
                const file = Math.round((fsize / 1024)); 
                // The size of the file.
                //Change the max_file_size as per your need 
                const max_file_size = 30720;
                if (file >= max_file_size) { 
                    alert( 
                      "File too Big, please select a file less than 30mb (10 sec at 1080p or 5 sec at 4k)"); 
                } else { 
                    $('#loader').removeClass('disabled').addClass('active');
                    document.getElementById("formsubmit").submit();
                } 
            } 
        } 
        
        
    };
    var recorder = document.getElementById('recorder');
	
	iframe = $("#hidden_frame");
	iframe.on('load',function(){
		$('#loader').removeClass('active');
      
        //var innerDoc = (iframe.contentDocument) ? iframe.contentDocument : iframe.contentWindow.document;
 		// html = innerDoc.innerHTML;

　　	//var reg = /<img\s+.*?src\s*=\s*(["'])([^.]+?(?:\.(jpg|jpeg|png|gif)))\1[^/]*?\/?>/ig;

 　　	//var result = html.match(reg);
 　　	//alert(result);

	});
</script> 
</body>
</html>
